# Modeller Manager

## Overview

The `ModellerManager` class is designed to facilitate the process of protein modeling by interfacing with the Modeller software. This class is responsible for setting up and running Modeller scripts, handling mutations, and organizing input and output files. It provides a convenient way to perform protein structure predictions and mutations in a structured and automated manner.

## Class Initialization

The constructor of the `ModellerManager` class takes several arguments:

- `isoform`: An object representing the isoform to be modeled.
- `mutation`: A list representing the mutation(s) to be applied to the isoform.
- `modeller_exec`: A string specifying the path to the Modeller executable.
- `model_cutoff`: An integer specifying the cutoff for model selection.

## Methods

### `__enter__` and `__exit__`

These methods allow the `ModellerManager` class to be used within a context manager, ensuring that resources are managed efficiently.

### `write`

This method prepares the necessary files for running Modeller. It applies mutations (if any) to the isoform sequence, writes the alignment file for Modeller, and generates the Modeller script.

### `write_script`

Generates the python script to be executed by Modeller. This script specifies the alignment file, template structures, and the sequence to be modeled. It also sets up the modeling parameters and scoring methods.

### `_mutate_reside`

A private method that applies the specified mutation to the isoform's aligned sequence. It returns a boolean indicating the success of the mutation.

### `_add_chain_breaks`

This private method adds chain breaks to the sequences in cases where there is insufficient coverage for a specified number of residues. It is used to prepare the sequences for modeling.

### `write_alignment`

Prepares the alignment file for Modeller, incorporating any mutations and chain breaks as necessary. This file is used by Modeller to understand the relationship between the template structures and the sequence to be modeled.

### `run`

Executes the Modeller script, performing the actual modeling process. It handles the creation of the output directory and the execution of the script within the appropriate environment.

### `load_log_file`

After Modeller has run, this method reads the log file generated by Modeller to extract the DOPE scores and other relevant metrics. This information is used for model selection and evaluation.
