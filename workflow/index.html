<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Understanding the Workflow - Monviso</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Understanding the Workflow";
        var mkdocs_page_input_path = "workflow.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Monviso
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../tutorial/">Quick start tutorial</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Understanding the Workflow</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#for-the-user">For the user</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#under-the-hood">Under the hood</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../FAQs/">FAQs</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Classes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../run/">Run</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../input_parser/">Input Parser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../database_parser/">Database Parser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cobalt_wrapper/">Cobalt wrapper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../file_handler/">File handler</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gene/">Gene</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../isoform/">Isoform</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../template/">Template</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pdb_manager/">PDB manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../modeller_manager/">Modeller manager</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Monviso</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Understanding the Workflow</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="workflow">Workflow</h1>
<h2 id="for-the-user">For the user</h2>
<ul>
<li>The user provides the parameters (software paths, model settings, ...)</li>
<li>The user provides a list of genes and mutations</li>
<li>MoNvIso searches UniProt's databases for the canonical sequence and other isoforms</li>
<li>In the output path, a directory is created for every gene</li>
<li>In every gene's directory, a sub-directory is created for every isoform</li>
<li>The PDB databank is queried for every sequence and returns a list of similar sequences</li>
<li>HMMER is used to combine the results and start a new search for templates</li>
<li>The PDB files of the templates are downloaded, and the template chain is extracted</li>
<li>The sequence of the extracted chains is aligned with the sequence to model</li>
<li>Chain breaks are introduced in place of large gaps</li>
<li>The number of mutations that are mappable and the value of sequence identity are measured</li>
<li>Isoforms are ranked based on their score (ability to model the mutated protein)</li>
<li>The aligned sequence is passed to Modeller for modelling</li>
</ul>
<h2 id="under-the-hood">Under the hood</h2>
<p>The MoNvIso run is coordinated by an instance of the Run class.</p>
<ul>
<li>The <code>Run.load_mutation_list()</code> method passes the mutation file to the Input parser, which returns the mutations in a list type</li>
<li>The <code>Run.load_input()</code> method takes the input parameters and passes them to the Input_parser file, which returns them processed as a dictionary</li>
<li>The <code>Run.create_genes()</code> method instances the Gene object, one object per gene to model. These genes are stored in a list as a local attribute of the Run.</li>
<li>The <code>Run.create_isoform()</code> method loads the UniProt databases via a Database_Parser object. The database returns one sequence per isoform per gene. Each is used to instance an Isoform object. Every isoform object is stored in a list as an attribute of the corresponding gene.</li>
<li>At this point, the Gene object and Isoform objects take care of creating their corresponding directories and .fasta files with the alignments</li>
<li>The Run object coordinates the creation of alignments with the <code>Run.run_blastp()</code>, <code>Run.run_cobalt()</code>, <code>Run.run_hmmsearch()</code> methods. Each isoform of each gene runs a blastp search, saves the output, creates a .hmm with HMMER, and uses it for a search with hmmsearch. The output contains the PDB IDs and chains of the best templates</li>
<li><code>Run.load_templates()</code>: For every proposed template, a Template instance is created, which takes care of downloading and extracting the chain and fasta sequence from the PDB file. The operations on the PDB file are managed by the PDB_manager class. All the sequences of the templates are aligned with Cobalt.</li>
<li><code>Run.select_isoform()</code>: For every isoform, the mutation score (How many mutations can be mapped on the sequence), structural score (sequence identity), and the Selection score (the first two combined) are calculated. The isoforms are ranked, and the ones with higher scores are preferred to model the mutation.</li>
<li><code>Run.start_modeller()</code>: The isoforms that can be modeled will create the Modeller input file and start a Modeller run.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../tutorial/" class="btn btn-neutral float-left" title="Quick start tutorial"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../FAQs/" class="btn btn-neutral float-right" title="FAQs">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../tutorial/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../FAQs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
